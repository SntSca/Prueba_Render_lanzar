<build>
  <plugins>
    <plugin>
      <groupId>org.jacoco</groupId>
      <artifactId>jacoco-maven-plugin</artifactId>
      <version>0.8.12</version>
      <executions>
        <execution>
          <id>prepare-agent-children</id>
          <goals>
            <goal>prepare-agent</goal>
          </goals>
          <phase>test-compile</phase>
        </execution>
        <execution>
          <id>merge</id>
          <phase>verify</phase>
          <goals>
            <goal>merge</goal>
          </goals>
          <configuration>
            <fileSets>
              <fileSet>
                <directory>${project.basedir}/usersbe/target</directory>
                <includes>
                  <include>jacoco.exec</include>
                </includes>
              </fileSet>
              <fileSet>
                <directory>${project.basedir}/EsiMediaContenidosG03/target</directory>
                <includes>
                  <include>jacoco.exec</include>
                </includes>
              </fileSet>
            </fileSets>
            <destFile>${project.basedir}/target/jacoco-combined.exec</destFile>
          </configuration>
        </execution>
        <execution>
          <id>report-merged</id>
          <phase>verify</phase>
          <goals>
            <goal>report</goal>
          </goals>
          <configuration>
            <dataFile>${project.basedir}/target/jacoco-combined.exec</dataFile>
            <outputDirectory>${project.basedir}/target/site/jacoco-aggregate</outputDirectory>
            <reports>
              <xml>true</xml>
              <html>true</html>
              <csv>false</csv>
            </reports>
            <classFiles>
              <fileset>
                <directory>${project.basedir}/usersbe/target/classes</directory>
              </fileset>
              <fileset>
                <directory>${project.basedir}/EsiMediaContenidosG03/target/classes</directory>
              </fileset>
            </classFiles>
            <sourceFiles>
              <fileset>
                <directory>${project.basedir}/usersbe/src/main/java</directory>
              </fileset>
              <fileset>
                <directory>${project.basedir}/EsiMediaContenidosG03/src/main/java</directory>
              </fileset>
            </sourceFiles>
          </configuration>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build>
